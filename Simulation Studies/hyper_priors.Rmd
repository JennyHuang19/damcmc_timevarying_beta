---
title: "hyper_priors"
author: "Jenny Yijian Huang"
date: "4/11/2022"
output: html_document
---

```{r}
#pi01_prior = list(list("a_pi01" = 100, "b_pi01" = 100), list("a_pi01" = 10, "b_pi01" = 10), list("a_pi01" = 1, "b_pi01" = 1), list("a_pi01" = 0.1, "b_pi01" = 0.1))

for(i in 1:length(pi01_prior)){
  sim_MM_long <- run_DAMCMC_complete_smallh6(
  theta0, cp_thin_Y, N = 20000,
  rho = 0.2, param = "bg", approx = "ldp",
  iota_dist = "exponential", gener = FALSE, b = 1/2,
  thin = 1, plt = 2500,
  par_prior = list(
    a_beta = 1, b_beta = 1,
    a_gamma = 1, b_gamma = 1,
    a_R0 = 2, b_R0 = 2,
    a_lambda = 1, b_lambda = 1,
    a_pi11 = 0, b_pi11 = 1,
    a_pi01 = pi01_prior[[i]]$a_pi01, b_pi01 = pi01_prior[[i]]$b_pi01
  ), 
  length_delta = 79,
  x_b_ratio = 2,
  gamma=1/(79/6)
  )
  
  print(analyze_dbeta(sim_MM_long$dbeta_lst))

  print(barplot(analyze_dbeta(sim_MM_long$dbeta_lst)[[2]], main="Change Point Locations", xlab="Change Point Location",  
   ylab="Proportion of MCMC Samples", 
   border="blue"))
}

```
# beta(100,100) recovered very similar results to the 1/2 all change point.
# beta(10,10) recovers very similar results but with lower posterior probability

# beta(1,1) did not recover any change points but got the highest relative probabilities accurate still.
# beta(0.1,0.1) did not recover any change points but got the highest relative probabilities accurate.

```{r}
pi11_prior = list(list("a_pi11" = 1, "b_pi11" = 100), list("a_pi11" = 10, "b_pi11" = 100), list("a_pi11" = 1, "b_pi11" = 10), list("a_pi11" = 1, "b_pi11" = 1))

for(i in 1:length(pi11_prior)){
  sim_MM_long <- run_DAMCMC_complete_smallh6(
  theta0, cp_thin_Y, N = 20000,
  rho = 0.2, param = "bg", approx = "ldp",
  iota_dist = "exponential", gener = FALSE, b = 1/2,
  thin = 1, plt = 5000,
  par_prior = list(
    a_beta = 1, b_beta = 1,
    a_gamma = 1, b_gamma = 1,
    a_R0 = 2, b_R0 = 2,
    a_lambda = 1, b_lambda = 1,
    a_pi11 = pi11_prior[[i]]$a_pi11, b_pi11 = pi11_prior[[i]]$b_pi11,
    a_pi01 = 500, b_pi01 = 500
  ), 
  length_delta = 79,
  x_b_ratio = 2,
  gamma=1/(79/6)
  )
  
  print(analyze_dbeta(sim_MM_long$dbeta_lst))

  print(barplot(analyze_dbeta(sim_MM_long$dbeta_lst)[[2]], main="Change Point Locations", xlab="Change Point Location",  
   ylab="Proportion of MCMC Samples", 
   border="blue"))
}
```

pi_11
# beta(1,100) 
# beta(10,100) more consecutive change points but not by much.

# beta(1,10) Recover correct changepoint locations with high marginal probability (with pi_01 of beta(500,500))
# beta(0.1,0.1) did not recover any change points but got the highest relative probabilities accurate. (lower probability of change points at each location with many low change point probabilities arising)

